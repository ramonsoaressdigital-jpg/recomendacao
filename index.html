<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MVP â€¢ RecomendaÃ§Ã£o AgronÃ´mica</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <h1>ğŸ§ª MVP â€¢ RecomendaÃ§Ã£o AgronÃ´mica</h1>

  <!-- 1ï¸âƒ£ Importar Laudo -->
  <section id="import-section" class="card">
    <h2>1ï¸âƒ£ Importar Laudo (CSV)</h2>
    <input id="fileInput" type="file" accept=".csv,text/csv" />
    <button id="btnImportCSV" class="btn">ğŸ“¥ Importar</button>
    <div id="csvTableWrap" class="tableWrap"></div>
  </section>

  <!-- 2ï¸âƒ£ Produtos -->
  <section id="product-section" class="card">
    <h2>2ï¸âƒ£ Produtos</h2>
    <!-- O formulÃ¡rio serÃ¡ injetado aqui -->
    <div id="productFormWrap"></div>
    
    <!-- Tabela de produtos fica fora do container que o renderForm() sobrescreve -->
    <div id="prodTableWrap" class="tableWrap" style="margin-top:16px"></div>
  </section>

  <!-- 3ï¸âƒ£ Editor de FÃ³rmulas -->
  <section id="formula-section" class="card">
    <h2>3ï¸âƒ£ Editor de FÃ³rmulas</h2>
    <textarea id="formulaInput" class="pill" rows="6"
      placeholder="Exemplo: return (#pH_00_20# * #Ca_00_20#) / @Adequado@;"></textarea>

    <div class="controls" style="grid-template-columns:1fr 1fr">
      <div>
        <label>VariÃ¡veis (@nome@)</label>
        <div id="varsList" class="controls"></div>
        <button id="btnAddVar" class="btn">â• VariÃ¡vel</button>
      </div>
      <div>
        <label>Valores de Solo (#nome#)</label>
        <div id="soilList" class="controls"></div>
        <button id="btnAddSoil" class="btn">â• Solo</button>
      </div>
    </div>

    <div class="controls" style="grid-template-columns:1fr 1fr; gap:12px">
      <div>
        <label>Profundidade</label>
        <select id="depthSelect" class="pill">
          <option value="">â€” Todas â€”</option>
        </select>
      </div>
    </div>
  </section>

  <!-- 4ï¸âƒ£ FÃ³rmulas cadastradas -->
  <section id="formula-multiple" class="card">
    <h2>ğŸ“˜ FÃ³rmulas cadastradas para recomendaÃ§Ã£o</h2>
    <form id="formFormulaTemp" class="controls" style="grid-template-columns: 1fr 1fr 2fr auto; gap: 8px;">
      <input id="attrFormula" class="pill" placeholder="Atributo (ex: P2O5_FOSFATAGEM)" required />
      <input id="nameFormula" class="pill" placeholder="Nome descritivo (ex: Fosfatagem P2O5)" />
      <textarea id="bodyFormula" class="pill" rows="2"
        placeholder="if(#pH_CaCl2_00_20# < 5.5){return 120}" required></textarea>
      <button id="btnAddFormulaTemp" class="btn">â• Adicionar</button>
    </form>
    <div id="listaFormulasTemp" class="tableWrap"></div>
  </section>

  <!-- 5ï¸âƒ£ Executar RecomendaÃ§Ãµes -->
  <section id="recommendation-section" class="card">
    <h2>4ï¸âƒ£ Executar RecomendaÃ§Ãµes</h2>
    <div class="controls">
      <button id="run-all" class="btn">ğŸš€ Executar RecomendaÃ§Ãµes</button>
      <button id="clear-results" class="btn">ğŸ§¹ Limpar Resultados</button>
    </div>
    <div id="resultados" class="tableWrap">
      <p style="color:var(--muted)">Nenhuma recomendaÃ§Ã£o executada ainda.</p>
    </div>
  </section>

  <script src="js/csv-reader.js"></script>
  <script src="js/product-crud.js"></script>   <!-- define window.ProductStore -->
  <script src="js/formula-engine.js"></script>
  <script type="module" src="js/main.js"></script> 
</body>
</html>
